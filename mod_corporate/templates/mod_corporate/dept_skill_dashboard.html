{% extends 'mod_corporate/base_corporate.html' %}
{% load humanize %}

{% block title %}{{block.super}} Department Skill Dashboard{% endblock title %}

{% block subStyle %}{% endblock subStyle %}

{% block content %}
<div class="card card-shadow">

  <div class="card-body">
    <div class="float-right">
      <a href="{% url 'Corporate:OrgDepartment' cor dept %}" class="btn btn-secondary"style="width: 6rem">Back</a>
    </div>
    <h3>{{ dept }} Department, {{ skill }} Skill Dashboard</h3>
  </div>
</div>
<br>
<div class="card card-shadow">
  <div class="card-body">
    <h4>Experience</h4>
    <div class="row">
      <div class="col-md-6"
    <p>Total Staff with {{ skill }} Skill by Age Bracket</p>
    <canvas id="staff-with-skill-chart" height="100px"></canvas>
    <script>
      window.onload = function() {
        var ctx = document.getElementById('staff-with-skill-chart').getContext('2d');
        window.myPie = new Chart(ctx, number_staff_skill_config);

        var hours_experience_ctx = document.getElementById('hours-experience-in-skill-by-age-chart').getContext('2d');
        window.myChart = new Chart(hours_experience_ctx, hours_experience_skills_config);

        var experience_rating_year_range_ctx = document.getElementById('experience-rating-year-range-chart').getContext('2d');
        window.myChart = new Chart(experience_rating_year_range_ctx, experience_rating_year_range_config);

        var wt_skills_used_year_range_ctx = document.getElementById('wt-skills-used-year-range-chart').getContext('2d');
        window.myChart = new Chart(wt_skills_used_year_range_ctx, wt_skills_used_year_range_config);

        var we_skills_used_year_range_ctx = document.getElementById('we-skills-used-year-range-chart').getContext('2d');
        window.myChart = new Chart(we_skills_used_year_range_ctx, we_skills_used_year_range_config);

        var hours_experience_lost_skills_year_config_ctx = document.getElementById('hours-experience-lost-in-skill-by-year-chart').getContext('2d');
        window.myChart = new Chart(hours_experience_lost_skills_year_config_ctx, hours_experience_lost_skills_year_config);

        var volume_skill_lost_by_month_last_year_ctx = document.getElementById('experience-lost in-skill-by-month-last-year-chart').getContext('2d');
        window.myChart = new Chart(volume_skill_lost_by_month_last_year_ctx, volume_skill_lost_by_month_last_year_config);
      };
    </script>
    <script>
    var number_staff_skill_config = {
      type: 'bar',
      data: {
          labels: {{ age_bracket_labels|safe }},
          datasets: [{
            label: 'Number Staff with Skill by Age Bracket',
            data: {{ number_age_brackets_data|safe }},
            order: 2,
              backgroundColor: [
                  '#218B82', '#9AD9DB', '#E5DBD9', '#98D4BB', '#EB96AA', '#C6C9D0',
              ],
              borderColor: [

              ],
              borderWidth: 1
          },  {
            label: 'Number Staff with Skill by Age Bracket',
            data: {{ freelance_number_age_brackets_data|safe }},
            type: 'line',
            order: 1,
            fill: false,
            borderColor: '#0000FF',
            borderWidth: 2,
            pointBorderWidth: 2,
            pointStyle: 'circle',
            pointHitRadius: 20,
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero: true
                  }
              }]
            },
          legend: {
              display: false,
              position: 'left',
              labels: {
                  fontColor: '#0000ff',
          },

          }
        }
    };

    </script>
    </div>
    <div class="col-md-6">
    <p>Total Hours Experience in {{ skill }} Skill by Age Bracket</p>
    <canvas id="hours-experience-in-skill-by-age-chart" height="100px"></canvas>
    <script>
    var hours_experience_skills_config = {
      type: 'bar',
      data: {
          labels: {{ age_bracket_labels|safe }},
          datasets: [{
            label: 'Hours Experience in Skill by Age Bracket',
            data: {{ hours_experience_age_brackets_data|safe }},
            order: 2,
              backgroundColor: [
                  '#B6D8F2', '#F4CFDF', '#5784BA', '#C54B6C', '#F5BFD2', '#E5DB9C',
              ],
              borderColor: [

              ],
              borderWidth: 1
          },  {
            label: 'Hours Freelance Experience in Skill by Age Bracket',
            data: {{ freelance_hours_experience_age_brackets_data|safe }},
            type: 'line',
            order: 1,
            fill: false,
            borderColor: '#0000FF',
            borderWidth: 2,
            pointBorderWidth: 2,
            pointStyle: 'circle',
            pointHitRadius: 20,
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero: true
                  }
              }]
            },
          legend: {
              display: false,
              position: 'left',
              labels: {
                  fontColor: '#0000ff',
          },

          }
        }
    };

  </script>
    </div>
    </div>

  </div>
</div>
<br>
<div class="card card-shadow">
  <div class="card-body">
    <h4>Average Rating for Staff with {{ skill }} Skill</h4>
    <div class="row">
      <div class="col-md-4">
        <p>Total Experience Rating</p>
        <div class="text-center" style="font-size:60px">
          <span class="my_auto" style="font-size:50px"><i class="fa fa-star" aria-hidden="true"></i></span>
          <span style="font-size:50px"><i class="fa fa-star" aria-hidden="true"></i></span>
          <span style="font-size:50px"><i class="fa fa-star" aria-hidden="true"></i></span>
          <span style="font-size:50px"><i class="fa fa-star-half-o" aria-hidden="true"></i></span>
          <span style="font-size:50px"><i class="fa fa-star-o" aria-hidden="true"></i></span>
        </div>
        <p>Freelance Experience Rating</p>
        <div class="text-center" style="font-size:60px">
          <span style="font-size:50px"><i class="fa fa-star" aria-hidden="true"></i></span>
          <span style="font-size:50px"><i class="fa fa-star" aria-hidden="true"></i></span>
          <span style="font-size:50px"><i class="fa fa-star" aria-hidden="true"></i></span>
          <span style="font-size:50px"><i class="fa fa-star" aria-hidden="true"></i></span>
          <span style="font-size:50px"><i class="fa fa-star-o" aria-hidden="true"></i></span>
        </div>
      </div>
      <div class="col-md-8">
        <p>Average Rating for Skill Work Experience by Year</p>
        <canvas id="experience-rating-year-range-chart" height="100px"></canvas>
        <script>
        var experience_rating_year_range_config = {
          type: 'line',
          data: {
              labels: {{ skills_used_year_range_labels|safe }},
              datasets: [{
                label: 'Experience Rating by Year Range',
                data: [2,2.5,3,4,3.5,3,3.5,4,3,3.5],
                order: 2,
                fill: false,
                borderWidth: 2,
                pointBorderWidth: 2,
                pointStyle: 'circle',
                pointHitRadius: 20,
                  backgroundColor: [
                      '#FF0000',
                  ],
                  borderColor: [
                      '#FF0000',
                  ],
              },  {
                label: 'Freelance Experience Rating by Year Range',
                data: [3,3,3.5,4,3,4,4.5,4,4,4.5],
                type: 'line',
                order: 1,
                fill: false,
                borderColor: '#0000FF',
                borderWidth: 2,
                pointBorderWidth: 2,
                pointStyle: 'circle',
                pointHitRadius: 20,
              }]
          },
          options: {
              scales: {
                  yAxes: [{
                      ticks: {
                          beginAtZero: true
                      }
                  }]
                },
              legend: {
                  display: false,
                  position: 'left',
                  labels: {
                      fontColor: '#0000ff',
              },

              }
            }
        };

      </script>
      </div>
    </div>
  </div>
</div>
<br>
<div class="card card-shadow">
  <div class="card-body">
    <h4>{{ skill }} Skill Training Details</h4>
    <div class="row">
      <div class="col-md-4">
        <p>Total Hours Training</p>
        <div class="text-center" style="font-size:60px">
          {{ total_sum_t_we|floatformat:0|intcomma }}
        </div>
        <p>Total Hours Freelance Training</p>
        <div class="text-center" style="font-size:60px">
          {{ total_sum_ft_we|floatformat:0|intcomma }}
        </div>
      </div>
      <div class="col-md-8">
        <p>Skill Training by Year</p>
        <canvas id="wt-skills-used-year-range-chart" height="100px"></canvas>
        <script>
        var wt_skills_used_year_range_config = {
          type: 'bar',
          data: {
              labels: {{ skills_used_year_range_labels|safe }},
              datasets: [{
                label: 'Hours Training in Skill by Year Range',
                data: {{ t_we_skills_used_year_range_data|safe }},
                order: 2,
                  backgroundColor: [
                      '#E8D595', '#8DA47E', '#CAE7E3', '#B2B2B2', '#EEB8C5', '#DCDBD9', '#FEC7BC', '#8EA4C8', '#C3B8AA', '#DEDCE4',
                  ],
                  borderColor: [

                  ],
                  borderWidth: 1
              },  {
                label: 'Hours Freelance Training in Skill by Year Range',
                data: {{ ft_we_skills_used_year_range_data|safe }},
                type: 'line',
                order: 1,
                fill: false,
                borderColor: '#0000FF',
                borderWidth: 2,
                pointBorderWidth: 2,
                pointStyle: 'circle',
                pointHitRadius: 20,
              }]
          },
          options: {
              scales: {
                  yAxes: [{
                      ticks: {
                          beginAtZero: true
                      }
                  }]
                },
              legend: {
                  display: false,
                  position: 'left',
                  labels: {
                      fontColor: '#0000ff',
              },

              }
            }
        };

      </script>
      </div>
    </div>
  </div>
</div>
<br>
<div class="card card-shadow">
  <div class="card-body">
    <h4>{{ skill }} Skill Work Experience Details</h4>
    <div class="row">
      <div class="col-md-4">
        <p>Total Hours Experience</p>
        <div class="text-center" style="font-size:60px">
          {{ total_sum_we|floatformat:0|intcomma }}
        </div>
        <p>Total Hours Freelance Experience</p>
        <div class="text-center" style="font-size:60px">
          {{ total_sum_f_we|floatformat:0|intcomma }}
        </div>
      </div>
      <div class="col-md-8">
        <p>Skill Utilised in Work Experience by Year</p>
        <canvas id="we-skills-used-year-range-chart" height="100px"></canvas>
        <script>
        var we_skills_used_year_range_config = {
          type: 'bar',
          data: {
              labels: {{ skills_used_year_range_labels|safe }},
              datasets: [{
                label: 'Hours Experience in Skill by Year Range',
                data: {{ we_skills_used_year_range_data|safe }},
                order: 2,
                  backgroundColor: [
                      '#E8D595', '#8DA47E', '#CAE7E3', '#B2B2B2', '#EEB8C5', '#DCDBD9', '#FEC7BC', '#8EA4C8', '#C3B8AA', '#DEDCE4',
                  ],
                  borderColor: [

                  ],
                  borderWidth: 1
              },  {
                label: 'Hours Freelance Experience in Skill by Year Range',
                data: {{ f_we_skills_used_year_range_data|safe }},
                type: 'line',
                order: 1,
                fill: false,
                borderColor: '#0000FF',
                borderWidth: 2,
                pointBorderWidth: 2,
                pointStyle: 'circle',
                pointHitRadius: 20,
              }]
          },
          options: {
              scales: {
                  yAxes: [{
                      ticks: {
                          beginAtZero: true
                      }
                  }]
                },
              legend: {
                  display: false,
                  position: 'left',
                  labels: {
                      fontColor: '#0000ff',
              },

              }
            }
        };

      </script>
      </div>
    </div>
  </div>
</div>
<br>
<div class="card card-shadow">
  <div class="card-body">
    <h4>Current Staff with {{ skill }} Skill</h4>
    <div class="container">
      <div class="row my-auto">
        <div class="col-md-3 h-100 text-center my-auto">
          <strong>Last name, First name</strong>
        </div>
        <div class="col-md-2 h-100 text-center my-auto">
          <strong>Date Joined</strong>
        </div>
        <div class="col-md-1 h-100 text-center my-auto">
          <strong>Tenure</strong>
        </div>
        <div class="col-md-2 h-100 text-center my-auto">
          <strong>Designation</strong>
        </div>
        <div class="col-md-2 h-100 text-center my-auto">
          <strong>Relationship</strong>
        </div>
        <div class="col-md-2 h-100 text-center my-auto">
          <strong></strong>
        </div>
      </div>

    {% for item in current_staff_skill %}
    <div class="row">
      <div class="card mt-1 card-hover" style="width: 100%;">
        <div class="card-body small-pad">
          <div class="row my-auto">
            <div class="col-md-3 h-100 text-center my-auto">
              {{ item.talent.last_name }}, {{ item.talent.first_name }}
            </div>
            <div class="col-md-2 h-100 text-center my-auto">
              {{ item.date_from }}
            </div>
            <div class="col-md-1 h-100 text-center my-auto">
              {{ item.tenure|floatformat:2 }}
            </div>
            <div class="col-md-2 h-100 text-center my-auto">
              {{ item.designation }}
            </div>
            <div class="col-md-2 h-100 text-center my-auto">
              {{ item.work_configeration }}
            </div>
            <div class="col-md-2 h-100 text-center my-auto">
              <div class="btn-toolbar">
                <div class="btn-group mr-2">
                  <a href="{% url 'Talent:APV_C' cor item.talent.alias %}" target="_blank">
                    <i class="fa fa-id-badge" aria-hidden="true"style="font-size:30px; color:black" data-toggle="tooltip" data-placement="top" title="View Profile"></i>
                  </a>
                </div>
                <div class="btn-group mr-2">
                  <i class="fa fa-folder-open-o" aria-hidden="true"  style="font-size:30px; color:blue" data-toggle="tooltip" data-placement="top" title="View {{ corp.company }} Work History"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% empty %}
      <p>You do not have any staff registered with this skill with your company.</p>
    {% endfor %}
    </div>
    <br>
    {% if current_staff_skill_count >= 10 %}
      <div class="float-right">
        <a href="{% url 'Corporate:DeptSkillCurrentStaff' cor dept skl %}" class="btn btn-primary"style="width: 10rem">View All Staff</a>
      </div>
    {% endif %}
  </div>
</div>
<br>
<div class="card card-shadow">
  <div class="card-body">
    <h4>Skills Lost</h4>
    <div class="row">
      <div class="col-md-6"
    <p>Volume of Skill Lost over last Year</p>
    <canvas id="experience-lost in-skill-by-month-last-year-chart" height="100px"></canvas>

    <script>
    var volume_skill_lost_by_month_last_year_config = {
      type: 'bar',
      data: {
          labels: {{ hours_experience_lost_month_labels|safe }},
          datasets: [{
            label: 'Hours Experience Lost in Skill by Month in Last Year',
            data: {{ hours_experience_lost_month_brackets_data|safe }},
            order: 2,
              backgroundColor: [
                    '#D5BDD5', '#BFABDC', '#7EAFC8', '#004698', '#0280BD', '#B8E1FF', '#5586BO', '#011F82', '#6D92DO', '#CED1E6', '#03417F', '#5883AD',
              ],
              borderColor: [

              ],
              borderWidth: 1
          },  {
            label: 'Hours Freelance Experience Lost in Skill by Month in Last Year',
            data: {{ hours_freelance_experience_lost_month_brackets_data|safe }},
            type: 'line',
            order: 1,
            fill: false,
            borderColor: '#0000FF',
            borderWidth: 2,
            pointBorderWidth: 2,
            pointStyle: 'circle',
            pointHitRadius: 20,
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero: true
                  }
              }]
            },
          legend: {
              display: false,
              position: 'left',
              labels: {
                  fontColor: '#0000ff',
          },

          }
        }
    };

    </script>

    </div>
    <div class="col-md-6">
    <p>Total Hours Experience Lost Over last Six Years</p>
    <canvas id="hours-experience-lost-in-skill-by-year-chart" height="100px"></canvas>
    <script>
    var hours_experience_lost_skills_year_config = {
      type: 'bar',
      data: {
          labels: {{ experience_lost_labels|safe }},
          datasets: [{
            label: 'Hours Experience Lost in Skill by Year',
            data: {{ hours_experience_lost_year_brackets_data|safe }},
            order: 2,
              backgroundColor: [
                  '#B6D8F2', '#F4CFDF', '#5784BA', '#C54B6C', '#F5BFD2', '#E5DB9C',
              ],
              borderColor: [

              ],
              borderWidth: 1
          },  {
            label: 'Hours Freelance Experience Lost in Skill by Year',
            data: {{ freelance_hours_experience_lost_year_brackets_data|safe }},
            type: 'line',
            order: 1,
            fill: false,
            borderColor: '#0000FF',
            borderWidth: 2,
            pointBorderWidth: 2,
            pointStyle: 'circle',
            pointHitRadius: 20,
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero: true
                  }
              }]
            },
          legend: {
              display: false,
              position: 'left',
              labels: {
                  fontColor: '#0000ff',
          },

          }
        }
    };

  </script>
    </div>
    </div>

  </div>
</div>
<br>
<div class="card card-shadow">
  <div class="card-body">
    <h4>Past Staff with {{ skill }} Skill</h4>
    <div class="container">
      <div class="row my-auto">
        <div class="col-md-3 h-100 text-center my-auto">
          <strong>Last name, First name</strong>
        </div>
        <div class="col-md-2 h-100 text-center my-auto">
          <strong>Date Left</strong>
        </div>
        <div class="col-md-1 h-100 text-center my-auto">
          <strong>Tenure</strong>
        </div>
        <div class="col-md-2 h-100 text-center my-auto">
          <strong>Designation</strong>
        </div>
        <div class="col-md-2 h-100 text-center my-auto">
          <strong>Relationship</strong>
        </div>
        <div class="col-md-2 h-100 text-center my-auto">
          <strong></strong>
        </div>
      </div>

    {% for item in past_staff_skill %}
    <div class="row">
      <div class="card mt-1 card-hover" style="width: 100%;">
        <div class="card-body small-pad">
          <div class="row my-auto">
            <div class="col-md-3 h-100 text-center my-auto">
              {{ item.talent.last_name }}, {{ item.talent.first_name }}
            </div>
            <div class="col-md-2 h-100 text-center my-auto">
              {{ item.date_to }}
            </div>
            <div class="col-md-1 h-100 text-center my-auto">
              {{ item.tenure|floatformat:2 }}
            </div>
            <div class="col-md-2 h-100 text-center my-auto">
              {{ item.designation }}
            </div>
            <div class="col-md-2 h-100 text-center my-auto">
              {{ item.work_configeration }}
            </div>
            <div class="col-md-2 h-100 text-center my-auto">
              <div class="btn-toolbar">
                <div class="btn-group mr-2">
                  <a href="{% url 'Talent:APV_C' cor item.talent.alias %}" target="_blank">
                    <i class="fa fa-id-badge" aria-hidden="true"style="font-size:30px; color:black" data-toggle="tooltip" data-placement="top" title="View Profile"></i>
                  </a>
                </div>
                <div class="btn-group mr-2">
                  <i class="fa fa-folder-open-o" aria-hidden="true"  style="font-size:30px; color:blue" data-toggle="tooltip" data-placement="top" title="View {{ corp.company }} Work History"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% empty %}
      <p>You do not have any past staff registered with this skill with your company.</p>
    {% endfor %}
    </div>
    <br>
    {% if past_staff_skill_count >= 10 %}
      <div class="float-right">
        <a href="{% url 'Corporate:DeptSkillPastStaff' cor dept skl %}" class="btn btn-primary"style="width: 10rem">View All Staff</a>
      </div>
    {% endif %}
  </div>
</div>

{% endblock content %}
